#!/usr/bin/env python3
import argparse
import requests

# TODO: read from command line or whatever
URL = "http://testphp.vulnweb.com"

parser = argparse.ArgumentParser()

parser.add_argument('--user_agent', dest='user_agent',
                    default="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36", help='the character name')
parser.add_argument('payload')

args = parser.parse_args()

headers = {
    'User-Agent': args.user_agent,
}


r = requests.get(f"{URL}{args.payload}", headers=headers)

print()
print(f"HTTP/{r.raw.version/10} {r.raw.status} {r.raw.reason}")
for k, v in r.raw.headers.items():
    print(f"{k}: {v}")
print(r.text)
print()
